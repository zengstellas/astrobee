<!-- HTML header for doxygen 1.9.0-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>NASA Astrobee Robot Software: GNC Matlab Code</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link rel="icon" href="favicon.png" type="image/png" />
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="freeflyer.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 70px;">
  <td id="projectlogo"><img alt="Logo" src="astrobee-logo.png" height="100"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">NASA Astrobee Robot Software
   &#160;<span id="projectnumber">0.15.2</span>
   </div>
   <div id="projectbrief">Flight software for the Astrobee robot operating inside the International Space Station.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('matlab.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">GNC Matlab Code </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>In this directory, all the matlab, simulink and embedded C++ functions used therein are stored.</p>
<p>This includes the EKF code, control, FAM, and simulator, as well as associated testing utilities.</p>
<h1><a class="anchor" id="autotoc_md218"></a>
Dependencies</h1>
<p>LUA and Eigen will need to be installed for the MATLAB environment to properly initialize. On Linux systems this should be taken care by the standard installation process. The model is designed to run in MATLAB/Simulink without additional toolboxes, although Simulink Coder and Simulink Embedded Coder are required to generate code.</p>
<h2><a class="anchor" id="autotoc_md219"></a>
For mac installs</h2>
<p>Although the full system FSW cannot be run on a mac, MATLAB development and simulation can be. LUA should be installed from <a href="https://www.lua.org/download.html">https://www.lua.org/download.html</a> If LUA does not get added to the default system path, the following hack seems to work: Right click on the MATLAB application and go "Show Package Contents". Then navigate to the bin folder and open the file matlab in a text editor. Change the first 3 lines to:</p>
<p>&gt;#!/bin/sh &gt;export PATH=$PATH:$HOME/Applications/bin &gt;# Copyright 1984-2016 The MathWorks, Inc.</p>
<p>&gt;Where, $HOME/Applications/bin is the directory pointing to your lua binaries.</p>
<h1><a class="anchor" id="autotoc_md220"></a>
The Simulink Code</h1>
<h2><a class="anchor" id="autotoc_md221"></a>
Code Organization</h2>
<p>There are 2 Simulink models that can be used to simulate the Astrobee system. The models are identical, except astrobee_control_sim has had the Kalman filter and vision navigation models removed due to complications with simulating vision navigation as well as the increased complexity of the Kalman filter. Additionally, the full up astrobee model has issues running on windows due to its use of hand coded optimized functions. For these reasons, it is recomended that astrobee_control_sim be used whenever possible.</p><ul>
<li>astrobee.slx file contains the full up control and pose determination software as well as an <a class="el" href="structIMU.html">IMU</a>, vision navigation, propulsion, and physics model.</li>
<li>astrobee_control_sim.slx contains the control software as well as an <a class="el" href="structIMU.html">IMU</a>, propulsion, and physics model.</li>
</ul>
<h2><a class="anchor" id="autotoc_md222"></a>
Open and Run in Matlab</h2>
<p>Once the dependencies have been installed as described above simply opening either the astrobee.slx or astrobee_control_sim.slx file should call all the necessary initialization files. For example scenario run files look at the file 'run_ctl_scn01'</p>
<h2><a class="anchor" id="autotoc_md223"></a>
Compilation</h2>
<p>The code can be generated from within matlab by running the command 'build_Proto4' or from a Linux terminal by running the shell script 'astrobee_gen_code.sh'</p>
<h2><a class="anchor" id="autotoc_md224"></a>
Embedded C++ Functions</h2>
<p>The Kalman filter utilizes several hand coded functions that are highly optimized using the Eigen library. These have to be built into mex files in order to simulate with simulink, this should happen automatically, but requires the eigen library to be installed and the Matlab mex tools (see matlab documentation on mex) to be configured to use an installed compiler. <br  />
</p>
<h2><a class="anchor" id="autotoc_md225"></a>
LUA Configuration in Matlab</h2>
<p>Tunable parameters are managed through LUA scripts, so as to be consistent with the rest of the Astrobee software. The GN&amp;C tunable parameters are located in the freeflyer/astrobee/config/gnc.config file. The matlab file tunable_init runs the LUA script and imports the variables into the MATLAB base workspace. Note, tunable parameters utilized by the GN&amp;C system must have the tun_ prefix in order to be properly autocoded as tunable variables. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.9.0-->
<!-- start footer part -->
</body>
</html>
